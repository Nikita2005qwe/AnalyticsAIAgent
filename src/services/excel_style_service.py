"""
–ú–æ–¥—É–ª—å: excel_style_service.py
–û–ø–∏—Å–∞–Ω–∏–µ: –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–≤–µ—Ç–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º Excel-—Ñ–∞–π–ª–æ–≤.

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π (–∑–∞–ª–∏–≤–æ–∫) –¥–ª—è —è—á–µ–µ–∫.
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∑–∞–ª–∏–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞–∫–ª–∞–¥–Ω–æ–π –∏ –µ—ë —Ä–µ–≥–∏–æ–Ω–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –µ–¥–∏–Ω–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∏–ª—è –≤–æ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ä–æ–ª—å:
- –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è **—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Excel**.
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç UI.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `InvoiceCheckerProcess._mark_excel()` –∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- openpyxl.styles.PatternFill ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ª–∏–≤–æ–∫
- models.invoice.Invoice ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏ —Ä–µ–≥–∏–æ–Ω–∞
"""

# --- –ò–º–ø–æ—Ä—Ç—ã –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ---
from typing import Optional

# --- –ò–º–ø–æ—Ä—Ç—ã –∏–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ ---
from openpyxl.styles import PatternFill

# --- –ò–º–ø–æ—Ä—Ç—ã –∏–∑ –º–æ–¥–µ–ª–µ–π ---
from src.models.invoice import Invoice

# –¶–≤–µ—Ç–∞ –¥–ª—è Excel (–º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –±—É–¥—É—â–µ–º)
FILL_FOUND = PatternFill(start_color="CCFFCC", end_color="CCFFCC", fill_type="solid")
# üü© –ó–µ–ª—ë–Ω—ã–π: –Ω–∞–∫–ª–∞–¥–Ω–∞—è –Ω–∞–π–¥–µ–Ω–∞ –≤ DMS

FILL_NOT_FOUND = PatternFill(start_color="FFCCCC", end_color="FFCCCC", fill_type="solid")
# üü• –ö—Ä–∞—Å–Ω—ã–π: –Ω–∞–∫–ª–∞–¥–Ω–∞—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

FILL_ERROR = PatternFill(start_color="FFFF99", end_color="FFFF99", fill_type="solid")
# üü® –ñ—ë–ª—Ç—ã–π: –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ (—Ç–∞–π–º–∞—É—Ç, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)

FILL_UNKNOWN_PREFIX = PatternFill(start_color="FFFFCC", end_color="FFFFCC", fill_type="solid")
# üü® –°–≤–µ—Ç–ª–æ-–∂—ë–ª—Ç—ã–π: –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å (–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–≥–∏–æ–Ω)

FILL_OTHER_REGION = PatternFill(start_color="CCDDFF", end_color="CCDDFF", fill_type="solid")
# üü¶ –°–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π: –Ω–∞–∫–ª–∞–¥–Ω–∞—è –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä—è–ª–∏ –°–∏–±–∏—Ä—å, –∞ –Ω–∞–∫–ª–∞–¥–Ω–∞—è –∏–∑ –£—Ä–∞–ª–∞)

FILL_PENDING = PatternFill(start_color="EEEEEE", end_color="EEEEEE", fill_type="solid")
# ‚¨ú –°–µ—Ä—ã–π: —Å—Ç–∞—Ç—É—Å "–æ–∂–∏–¥–∞–µ—Ç" (–Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å)

class ExcelStyleService:
    """
    –°–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫ —è—á–µ–π–∫–∞–º Excel.

    –ê—Ç—Ä–∏–±—É—Ç—ã:
    - –ù–µ—Ç (—Å–µ—Ä–≤–∏—Å –±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äî pure functions)
    """

    def get_fill_for_invoice(self, invoice: Invoice, current_region: Optional[str] = None) -> PatternFill:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –∑–∞–ª–∏–≤–∫—É –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ —è—á–µ–π–∫–µ —Å –Ω–æ–º–µ—Ä–æ–º –Ω–∞–∫–ª–∞–¥–Ω–æ–π.

        Args:
            invoice (Invoice): –û–±—ä–µ–∫—Ç –Ω–∞–∫–ª–∞–¥–Ω–æ–π
            current_region (str, optional): –†–µ–≥–∏–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Å–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "siberia")

        Returns:
            PatternFill: –¶–≤–µ—Ç–æ–≤–∞—è –∑–∞–ª–∏–≤–∫–∞ –¥–ª—è —è—á–µ–π–∫–∏

        –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞:
        1. –ï—Å–ª–∏ —É –Ω–∞–∫–ª–∞–¥–Ω–æ–π –µ—Å—Ç—å –æ—à–∏–±–∫–∞ ‚Üí FILL_ERROR
        2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí FILL_FOUND
        3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí FILL_NOT_FOUND
        4. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å "unknown" (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å) ‚Üí FILL_UNKNOWN_PREFIX
        5. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞, –Ω–æ –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ ‚Üí FILL_OTHER_REGION
        6. –ò–Ω–∞—á–µ ‚Üí FILL_PENDING (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)

        –ü—Ä–∏–º–µ—Ä—ã:
            - invoice.found_in_dms = True ‚Üí –∑–µ–ª—ë–Ω—ã–π
            - invoice.found_in_dms = False ‚Üí –∫—Ä–∞—Å–Ω—ã–π
            - invoice.error_message = "Timeout" ‚Üí –∂—ë–ª—Ç—ã–π
            - invoice.region = "ural", current_region = "siberia" ‚Üí —Å–∏–Ω–∏–π

        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
            InvoiceCheckerProcess._mark_excel()
            –ë—É–¥—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö —Å Excel-–æ—Ç—á—ë—Ç–∞–º–∏
        """
        pass

    def apply_fill_to_cell(self, cell, invoice: Invoice, current_region: Optional[str] = None):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∑–∞–ª–∏–≤–∫—É –∫ —è—á–µ–π–∫–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∫–ª–∞–¥–Ω–æ–π.

        Args:
            cell: –Ø—á–µ–π–∫–∞ openpyxl (–Ω–∞–ø—Ä–∏–º–µ—Ä, ws['A1'])
            invoice (Invoice): –ù–∞–∫–ª–∞–¥–Ω–∞—è
            current_region (str, optional): –¢–µ–∫—É—â–∏–π —Ä–µ–≥–∏–æ–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏

        –®–∞–≥–∏:
        1. –ü–æ–ª—É—á–∏—Ç—å –∑–∞–ª–∏–≤–∫—É —á–µ—Ä–µ–∑ self.get_fill_for_invoice()
        2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cell.fill = fill

        –£–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ü–∏–∫–ª–µ:
            for cell, invoice in zip(cells, invoices):
                style_service.apply_fill_to_cell(cell, invoice, current_region="siberia")
        """
        pass

    def get_fill_by_status(self, status: str) -> PatternFill:
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–ª–∏–≤–∫—É –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É —Å—Ç–∞—Ç—É—Å—É.

        Args:
            status (str): "found", "not_found", "error", "unknown", "pending"

        Returns:
            PatternFill: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∑–∞–ª–∏–≤–∫–∞

        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ —É —Ç–µ–±—è –Ω–µ—Ç –æ–±—ä–µ–∫—Ç–∞ Invoice, –∞ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å.
        –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–∑ –ª–æ–≥–∞.
        """
        pass