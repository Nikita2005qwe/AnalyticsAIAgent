"""
–ú–æ–¥—É–ª—å: main_window.py
–ö–ª–∞—Å—Å: MainWindow

–û–ø–∏—Å–∞–Ω–∏–µ: –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–µ —Å–æ–±–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ (tabbed interface).

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–∂–µ—Ç–æ–≤-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö", "–ó–∞–¥–∞—á–∏").
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏.
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–º –≤–∏–¥–æ–º –æ–∫–Ω–∞: –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ä–∞–∑–º–µ—Ä, –∏–∫–æ–Ω–∫–∞, —Å—Ç–∏–ª–∏.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ä–æ–ª—å:
- UI-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä: –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã –∫–∞–∫ –≤–∫–ª–∞–¥–∫–∏.
- –ß–∞—Å—Ç—å —Å–ª–æ—è `ui`, –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.
- –ü–æ–ª—É—á–∞–µ—Ç –≤–∏–¥–∂–µ—Ç—ã –æ—Ç `Application` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ `add_tab()`.

–í–µ—Ä—Å–∏—è: v0.1
–ê–≤—Ç–æ—Ä: –ë–æ—Ä—è–∫–æ–≤
–î–∞—Ç–∞: 21.08.2025
–°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤
"""

# --- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ---
from typing import Optional
import os

# --- PyQt5 ---
from PyQt5.QtWidgets import (
    QMainWindow,  # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    QTabWidget,  # –í–∏–¥–∂–µ—Ç —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ ‚Äî –æ—Å–Ω–æ–≤–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    QWidget,  # –ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è UI-—ç–ª–µ–º–µ–Ω—Ç–æ–≤
    QVBoxLayout,  # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞
    QHBoxLayout,  # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞
    QMessageBox,  # –î–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞)
    QFrame,  # –õ—ë–≥–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    QScrollArea, QSizePolicy, QSplitter, QPushButton  # –î–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é)
)
from PyQt5.QtGui import QIcon  # –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∫–æ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
from PyQt5.QtCore import Qt, pyqtSignal  # Qt ‚Äî —Ñ–ª–∞–≥–∏, pyqtSignal ‚Äî –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

# --- –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ ---
from src.core.logger import Logger  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
from src.ui.log_widget import LogWidget


class MainWindow(QMainWindow):
    """
    –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ –∏ –±–æ–∫–æ–≤—ã–º –º–µ–Ω—é.

    –ê—Ç—Ä–∏–±—É—Ç—ã:
    - tab_widget (QTabWidget): —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–π –≤–∫–ª–∞–¥–∫–∏
    - sidebar_layout (QVBoxLayout): –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (–±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é)
    - _logger (Logger): —ç–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–≥–µ—Ä–∞ –¥–ª—è –æ—Ç—á—ë—Ç–∞ –æ —Å–æ–±—ã—Ç–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–í–∫–ª–∞–¥–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞")

    –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
    - –ù–µ —Ö—Ä–∞–Ω–∏—Ç —Ä–µ–µ—Å—Ç—Ä –≤–∏–¥–∂–µ—Ç–æ–≤ (self.tabs —É–¥–∞–ª—ë–Ω) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç QTabWidget –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
    - –ü–æ–ª—É—á–∞–µ—Ç –≤–∏–¥–∂–µ—Ç—ã –æ—Ç Application —á–µ—Ä–µ–∑ add_tab()
    - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
    - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    """

    def __init__(self, logger: Logger):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º QTabWidget.

        Args:
            logger (Logger): –≠–∫–∑–µ–º–ø–ª—è—Ä –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–±—ã—Ç–∏–π

        –®–∞–≥–∏:
        1. –í—ã–∑–≤–∞—Ç—å super().__init__() ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è QMainWindow
        2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å self._logger = logger ‚Äî –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π
        3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å self.tab_widget = None ‚Äî –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ setup_ui
        4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å self.sidebar_layout = None ‚Äî –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ setup_ui

        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        - MainWindow –Ω–µ –∑–Ω–∞–µ—Ç –æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ, —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–∫–ª–∞–¥–∫–∏
        - –í—Å–µ –≤–∏–¥–∂–µ—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ add_tab() –∏–∑ Application
        - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç QTabWidget –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –æ –≤–∫–ª–∞–¥–∫–∞—Ö
        """
        super().__init__()
        self._current_widget = None
        self.splitter = None
        self.log_widget = None
        self.sidebar_layout = None
        self.central_widget = None
        self.central_layout = None
        self._logger = logger

    def setup_ui(
        self,
        icon_file_name: str = "assets/icon.png",
        style_file: str = "styles/app.qss",
        initial_size: list = None,
        full_screen: bool = False,
        maximized: bool = False):
        """
        –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞.

        Args:
            icon_file_name (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–∫–æ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            style_file (str): –ü—É—Ç—å –∫ QSS-—Ñ–∞–π–ª—É —Å–æ —Å—Ç–∏–ª—è–º–∏

        –®–∞–≥–∏:
        1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞: "AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞"
        2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 1920x1080 (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è Full HD)
        3. –°–æ–∑–¥–∞—Ç—å –≥–ª–∞–≤–Ω—ã–π layout: QHBoxLayout ‚Äî –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
        4. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä-–≤–∏–¥–∂–µ—Ç –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –∫–∞–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
        5. –°–æ–∑–¥–∞—Ç—å –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (sidebar):
           - QWidget —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω–æ–π 250px
           - QVBoxLayout –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
           - –û—Ç—Å—Ç—É–ø—ã: 8px
        6. –°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π QTabWidget:
           - setTabsClosable(False) ‚Äî –≤–∫–ª–∞–¥–∫–∏ –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã–≤–∞—Ç—å
           - setMovable(True) ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å
        7. –†–∞–∑–º–µ—Å—Ç–∏—Ç—å sidebar –∏ tab_widget –≤ –≥–ª–∞–≤–Ω–æ–º layout:
           - sidebar ‚Äî —Å–ª–µ–≤–∞
           - tab_widget ‚Äî —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
        8. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        9. –ü—Ä–∏–º–µ–Ω–∏—Ç—å QSS-—Å—Ç–∏–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞
        10. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —É—Å–ø–µ—à–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É UI

        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        - QTabWidget ‚Äî —Ä–æ–¥–Ω–æ–π —ç–ª–µ–º–µ–Ω—Ç PyQt5, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
        - –ú–æ–∂–Ω–æ –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é (–ü–ö–ú –ø–æ –≤–∫–ª–∞–¥–∫–µ ‚Üí –∑–∞–∫—Ä—ã—Ç—å, –æ–±–Ω–æ–≤–∏—Ç—å).
        - sidebar_layout –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è Application –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        """
        self.setWindowTitle("AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞")
        # üîπ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä
        size = initial_size if initial_size and len(initial_size) == 2 else [1920, 1080]

        if maximized:
            self.resize(size[0], size[1])  # ‚Üê –Ω—É–∂–µ–Ω resize –î–û showMaximized()
            self.showMaximized()
        else:
            self.resize(size[0], size[1])
            self.setMinimumSize(1200, 800)
        # === –ì–ª–∞–≤–Ω—ã–π layout (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π) ===
        main_layout = QVBoxLayout()
        container = QWidget()
        container.setLayout(main_layout)
        self.setCentralWidget(container)

        # === –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–ø–ª–∏—Ç: sidebar + central ===
        split_layout = QHBoxLayout()
        split_widget = QWidget()
        split_widget.setLayout(split_layout)
        main_layout.addWidget(split_widget)

        # === –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (—Å–ª–µ–≤–∞) ---
        sidebar_widget = QWidget()
        sidebar_widget.setFixedWidth(250)
        sidebar_widget.setStyleSheet("background-color: #f0f0f0; border-right: 1px solid #ccc;")
        self.sidebar_layout = QVBoxLayout()
        self.sidebar_layout.setAlignment(Qt.AlignLeft)  # ‚Üê –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é
        self.sidebar_layout.setSpacing(6)  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏
        self.sidebar_layout.setContentsMargins(8, 8, 8, 8)
        sidebar_widget.setLayout(self.sidebar_layout)
        split_layout.addWidget(sidebar_widget)

        # --- 2. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å layout'–æ–º ---
        central_container = QWidget()
        self.central_layout = QVBoxLayout()
        self.central_layout.setContentsMargins(0, 0, 0, 0)
        self.central_layout.setSpacing(0)
        central_container.setLayout(self.central_layout)
        central_container.setStyleSheet("background-color: white;")
        split_layout.addWidget(central_container)

        # === 3. –û–∫–Ω–æ –ª–æ–≥–æ–≤ (—Å–Ω–∏–∑—É, –ø–æ–¥ –≤—Å–µ–º) ===
        self.log_widget = LogWidget()
        self.log_widget.setMaximumHeight(600)  # –ú–∞–∫—Å–∏–º—É–º, –¥–æ –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–Ω–æ —Ä–∞—Å—Ç—è–Ω—É—Ç—å
        self.log_widget.setMinimumHeight(400)  # –ú–∏–Ω–∏–º—É–º

        # === –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å + –ª–æ–≥–∏ ===
        self.splitter = QSplitter(Qt.Vertical)
        self.splitter.setStyleSheet("""
            QSplitter::handle {
                background-color: #e0e0e0;
                height: 10px;
                border-top: 1px solid #cccccc;
                border-bottom: 1px solid #cccccc;
            }
            QSplitter::handle:hover {
                background-color: #d0d0d0;
            }
        """)
        # –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å (sidebar + —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
        top_widget = QWidget()
        top_layout = QHBoxLayout()
        top_layout.setContentsMargins(0, 0, 0, 0)
        top_layout.addWidget(split_widget)
        top_widget.setLayout(top_layout)

        # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–ª–∏—Ç—Ç–µ—Ä
        self.splitter.addWidget(top_widget)
        self.splitter.addWidget(self.log_widget)

        # === 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: –ª–æ–≥–∏ ‚Äî 500px (–º–∞–∫—Å–∏–º—É–º)
        self.splitter.setSizes([self.height() - 500, 500])
        # –í–∞–∂–Ω–æ: —á—Ç–æ–±—ã –ø–∞–Ω–µ–ª—å –ª–æ–≥–æ–≤ –Ω–µ "—Å—Ö–ª–æ–ø—ã–≤–∞–ª–∞—Å—å"
        self.splitter.setChildrenCollapsible(False)

        # –î–æ–±–∞–≤–ª—è–µ–º —Å–ø–ª–∏—Ç—Ç–µ—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–π layout
        main_layout.addWidget(self.splitter)
        # === –ò–∫–æ–Ω–∫–∞ –∏ —Å—Ç–∏–ª–∏ ===
        if os.path.exists(icon_file_name):
            try:
                self.setWindowIcon(QIcon(icon_file_name))
            except Exception as e:
                self._logger.warning(f"–ò–∫–æ–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞: {e}")

        self._apply_styles(style_file)
        self._logger.info("–ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ: UI –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ")

    def show_logs_panel(self, visible: bool):
        """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–ª–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å –ª–æ–≥–æ–≤"""
        self.log_widget.setVisible(visible)
        # –ú–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∞–∑–º–µ—Ä–∞–º–∏
        if visible:
            sizes = self.splitter.sizes()
            if sum(sizes) > 0:
                total = sum(sizes)
                self.splitter.setSizes([int(total * 0.7), int(total * 0.3)])
                
    def _apply_styles(self, style_file: str):
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç QSS-—Å—Ç–∏–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

        Args:
            style_file (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å—Ç–∏–ª–µ–π

        –®–∞–≥–∏:
        1. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8
        2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ setStyleSheet()
        3. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —É—Å–ø–µ—à–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É
        4. –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å
        5. –ü—Ä–∏ –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–∫–∞—Ö ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É

        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        - QSS (Qt Style Sheets) ‚Äî –∞–Ω–∞–ª–æ–≥ CSS –¥–ª—è PyQt
        - –°—Ç–∏–ª–∏ –º–æ–≥—É—Ç –∑–∞–¥–∞–≤–∞—Ç—å —Ü–≤–µ—Ç–∞, —à—Ä–∏—Ñ—Ç—ã, –æ—Ç—Å—Ç—É–ø—ã, —ç—Ñ—Ñ–µ–∫—Ç—ã
        - –ü–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
        """
        try:
            with open(style_file, "r", encoding="utf-8") as f:
                style_content = f.read()
            self.setStyleSheet(style_content)
            self._logger.info(f"–°—Ç–∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ {style_file}")
        except FileNotFoundError:
            self._logger.warning(f"–§–∞–π–ª —Å—Ç–∏–ª–µ–π {style_file} –Ω–µ –Ω–∞–π–¥–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.")
        except Exception as e:
            self._logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∏–ª–µ–π: {e}")

    def switch_to(self, widget: QWidget):
        """
        –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≤–∏–¥–∂–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
        –¢–∞–∫–∂–µ —Å–Ω–∏–º–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ 'checked' —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞ —Ç–µ–∫—É—â—É—é.

        Args:
            widget (QWidget): –Ω–æ–≤—ã–π –≤–∏–¥–∂–µ—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, SettingsAppView)

        –®–∞–≥–∏:
        1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É–∂–µ –≤–∏–¥–∂–µ—Ç –≤ central_layout
        2. –ï—Å–ª–∏ –µ—Å—Ç—å ‚Äî —É–¥–∞–ª–∏—Ç—å –µ–≥–æ –∏–∑ layout (—á–µ—Ä–µ–∑ setParent(None))
        3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –≤–∏–¥–∂–µ—Ç –≤ central_layout
        4. –ù–∞–π—Ç–∏ navigation_button —É –Ω–æ–≤–æ–≥–æ –≤–∏–¥–∂–µ—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å) –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å checked=True
        5. –°–Ω—è—Ç—å checked —Å–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –≤ sidebar_layout
        6. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É –≤–∏–¥–∂–µ—Ç–∞

        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        - –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ –≤ –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π
        - –£–ª—É—á—à–∞–µ—Ç UX: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏—Ç, –∫–∞–∫–∞—è –≤–∫–ª–∞–¥–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞
        """
        # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –≤–∏–¥–∂–µ—Ç –∏–∑ layout
        if self.central_layout.count() > 0:
            old_widget = self.central_layout.itemAt(0).widget()
            if old_widget:
                old_widget.setParent(None)

        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π
        self.central_layout.addWidget(widget)
        self._current_widget = widget

        # === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ ===
        # –°–Ω–∏–º–∞–µ–º checked —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
        for i in range(self.sidebar_layout.count()):
            item = self.sidebar_layout.itemAt(i)
            if item and item.widget():
                btn = item.widget()
                if isinstance(btn, QPushButton) and btn.isCheckable():
                    btn.setChecked(False)

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º checked –Ω–∞ —Ç–µ–∫—É—â—É—é –∫–Ω–æ–ø–∫—É
        if hasattr(widget, 'navigation_button') and widget.navigation_button:
            widget.navigation_button.setChecked(True)
        
    def current_widget(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –≤–∏–¥–∂–µ—Ç."""
        return self._current_widget

    def closeEvent(self, event):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞.

        Args:
            event (QCloseEvent): –°–æ–±—ã—Ç–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è

        –®–∞–≥–∏:
        1. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ: "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è..."
        2. –ü–æ–∫–∞–∑–∞—Ç—å QMessageBox —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –≤—ã—Ö–æ–¥–∞
        3. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª ‚Äî –ø—Ä–∏–Ω—è—Ç—å —Å–æ–±—ã—Ç–∏–µ
        4. –ò–Ω–∞—á–µ ‚Äî –æ—Ç–∫–ª–æ–Ω–∏—Ç—å

        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        - –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        - –Ø–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –¥–ª—è GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
        - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—ã—Ö–æ–¥–æ–º
        """
        self._logger.info("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è...")

        reply = QMessageBox.question(
            self,
            "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞",
            "–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?",
            QMessageBox.Yes | QMessageBox.No,
            QMessageBox.No
        )

        if reply == QMessageBox.Yes:
            event.accept()
            self._logger.info("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        else:
            event.ignore()
            self._logger.info("–ó–∞–∫—Ä—ã—Ç–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")